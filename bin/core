#!/usr/bin/env php
<?php

$rootPath = '/../..';

if (strpos(__DIR__, '/simplon/core/bin') !== false)
{
    $rootPath = '/../../../..';
}

$rootPath = __DIR__ . $rootPath;

/** @noinspection PhpIncludeInspection */
require $rootPath . '/vendor/autoload.php';

use Silly\Application;
use Simplon\Core\CoreContext;

$app = new Application();
$pathRoot = CoreContext::APP_PATH;
$pathSkeleton = $pathRoot . '/../vendor/simplon/core/skeleton';

require $pathSkeleton . '/utils/TemplateUtil.php';
require $pathSkeleton . '/utils/ComponentSkeleton.php';
require $pathSkeleton . '/utils/InitSkeleton.php';

// ##############################################

$app
    ->command('init name [--with-view]', InitSkeleton::process($pathRoot, $pathSkeleton))
    ->descriptions('Init your app', [
        'name'        => 'App name',
        '--with-view' => 'Enable view',
    ])
;

// ##############################################

$app
    ->command('component name [--with-rest] [--with-view=]', ComponentSkeleton::process($pathRoot, $pathSkeleton))
    ->descriptions('Add a component', [
        'name'        => 'Component name',
        '--with-rest' => 'Enable REST',
        '--with-view' => 'Enable view with first view name',
    ])
;

// ##############################################

$app
    ->command('store component store model [--with-token]', ComponentSkeleton::process($pathRoot, $pathSkeleton))
    ->descriptions('Add a store/model to an existing component', [
        'component'    => 'Component name',
        'store'        => 'Store name',
        'model'        => 'Model name',
        '--with-token' => 'Enable token',
    ])
;

// ##############################################

$app->run();